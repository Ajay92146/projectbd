<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tab Test - Simple</title>
    <style>
        .dropdown-item { padding: 10px; margin: 5px; border: 1px solid #ccc; cursor: pointer; }
        .tab-content { padding: 20px; border: 1px solid #000; margin: 10px 0; }
        .tab-button { padding: 10px; margin: 5px; background: #f0f0f0; cursor: pointer; }
        .active { background: #007bff; color: white; }
        .debug { background: #ffffcc; padding: 10px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>Tab Switching Test</h1>
    
    <div class="debug" id="debugLog">Debug Log:</div>
    
    <h2>Dropdown Items (like in navbar)</h2>
    <div class="dropdown-item" data-tab="donations" id="donationsDropdown">My Donations</div>
    <div class="dropdown-item" data-tab="requests" id="requestsDropdown">My Requests</div>
    <div class="dropdown-item" data-tab="settings" id="settingsDropdown">Settings</div>
    
    <h2>Tab Buttons (like in main content)</h2>
    <div class="tab-button active" data-tab="donations" id="donationsTab">My Donations</div>
    <div class="tab-button" data-tab="requests" id="requestsTab">My Requests</div>
    <div class="tab-button" data-tab="settings" id="settingsTab">Settings</div>
    
    <h2>Tab Content</h2>
    <div class="tab-content" id="donations" style="display: block;">DONATIONS CONTENT</div>
    <div class="tab-content" id="requests" style="display: none;">REQUESTS CONTENT</div>
    <div class="tab-content" id="settings" style="display: none;">SETTINGS CONTENT</div>

    <script>
        function log(message) {
            const debugElement = document.getElementById('debugLog');
            debugElement.innerHTML += '<br>' + new Date().toLocaleTimeString() + ': ' + message;
        }

        // Exact same switchToTab function as in profile.html
        window.switchToTab = function(tabName) {
            log('ðŸ”„ Switching to tab: ' + tabName);
            
            // Hide all tab contents
            const allTabContents = document.querySelectorAll('.tab-content');
            allTabContents.forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons (both .tab-btn and .tab-button)
            const allTabButtons = document.querySelectorAll('.tab-btn, .tab-button');
            allTabButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show the selected tab content
            const targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.style.display = 'block';
                targetTab.classList.add('active');
                log('âœ… Tab content shown: ' + tabName);
            } else {
                log('âŒ Tab not found: ' + tabName);
            }
            
            // Activate the corresponding tab button (specifically look for .tab-button class)
            const targetButton = document.querySelector(`.tab-button[data-tab="${tabName}"]`);
            if (targetButton) {
                targetButton.classList.add('active');
                log('âœ… Tab button activated: ' + tabName);
            } else {
                log('âŒ Tab button not found for: ' + tabName);
            }
            
            // Update dropdown active state - mark the corresponding dropdown item as active
            const allDropdownItems = document.querySelectorAll('.dropdown-item');
            allDropdownItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Set active state for the selected dropdown item
            const targetDropdownItem = document.querySelector(`.dropdown-item[data-tab="${tabName}"]`);
            if (targetDropdownItem) {
                targetDropdownItem.classList.add('active');
                log('âœ… Dropdown item activated: ' + tabName);
            }
        };

        // Setup event listeners
        document.addEventListener('DOMContentLoaded', function() {
            log('ðŸš€ Initializing...');
            
            // Tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            log('ðŸ“‹ Found tab buttons: ' + tabButtons.length);
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    log('ðŸ”˜ Tab button clicked: ' + tabName);
                    if (tabName) {
                        window.switchToTab(tabName);
                    }
                });
            });
            
            // Dropdown items
            const dropdownTabItems = document.querySelectorAll('[data-tab]:not(.tab-button)');
            log('ðŸ“‹ Found dropdown tab items: ' + dropdownTabItems.length);
            dropdownTabItems.forEach((item, index) => {
                const tabName = item.getAttribute('data-tab');
                log(`ðŸ“‹ Dropdown item ${index}: ` + tabName);
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const tabName = this.getAttribute('data-tab');
                    if (tabName) {
                        log('ðŸ”„ Dropdown tab clicked: ' + tabName);
                        window.switchToTab(tabName);
                    }
                });
            });
            
            log('âœ… Initialization complete');
        });
    </script>
</body>
</html>